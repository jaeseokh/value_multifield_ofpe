[
  {
    "objectID": "01.Overview.html",
    "href": "01.Overview.html",
    "title": "1  Overview",
    "section": "",
    "text": "Background\nCode\ncoords &lt;- sf::st_coordinates(field_centroids_sf)\n\nfield_points_public &lt;- field_centroids_sf |&gt;\n  mutate(\n    lon = coords[, \"X\"],\n    lat = coords[, \"Y\"],\n    lon_round = round(lon, 1),\n    lat_round = round(lat, 1)\n  ) |&gt;\n  select(ffy_id, farm, field, year, stusps, lon_round, lat_round) |&gt;\n  st_as_sf(coords = c(\"lon_round\", \"lat_round\"), crs = 4326)\n\nfig1_field_loc &lt;- ggplot() +\n  geom_sf(data = ofpe_states_sf, fill = \"grey95\", color = \"grey80\") +\n  geom_sf(\n    data  = field_points_public,\n    color = \"black\",\n    alpha = 0.15,\n    size  = 8,\n    shape = 16\n  ) +\n  theme_minimal() +\n  coord_sf(\n    xlim = range(sf::st_coordinates(ofpe_states_sf)[, 1]),\n    ylim = range(sf::st_coordinates(ofpe_states_sf)[, 2])\n  ) +\n  labs(x = NULL, y = NULL)\n\nfig1_field_loc\n\n\n\n\n\nFigure 1. Location of OFPE fields across the Midwest U.S.\nThis figure shows the approximate locations of all OFPE fields used in the project. Coordinates are intentionally coarsened to protect field privacy and highlight only the spatial footprint and weather-diversity motivating the multi-field analysis.",
    "crumbs": [
      "Tree Ensemble Prediction (2022)",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Overview</span>"
    ]
  },
  {
    "objectID": "01.Overview.html#research-objectives",
    "href": "01.Overview.html#research-objectives",
    "title": "1  Overview",
    "section": "Research Objectives",
    "text": "Research Objectives\nThe original objective was to use multi-field OFPE data to predict yield–nitrogen (yield–N) response at new fields, asking:\n\nCan yield–N responses at one field inform predictions at another?\n\nHow transferable are empirical relationships across fields and years?\n\nCan purely data-driven ML models extract cross-field structure?\n\nThese questions shaped the 2022 modeling strategy.",
    "crumbs": [
      "Tree Ensemble Prediction (2022)",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Overview</span>"
    ]
  },
  {
    "objectID": "01.Overview.html#method",
    "href": "01.Overview.html#method",
    "title": "1  Overview",
    "section": "Method",
    "text": "Method\nThe 2022 analysis used tree-ensemble models:\n\nRandom Forests\n\nXGBoost\n\nBy these model the yield(\\(bu/ac\\)) of OFPE fields were trained on:\n\nNitrogen rate (\\(lbs/ac\\))\nSSURGO soil attributes1\n\nDEM-derived2 topography\n\nIn-season accumulated weather info (precipitation(\\(mm\\)), GDD3, EDD4 )\n\nWith generalization assessed via the cross-validation method:\n\nLeave-One-Location-Out (LOLO) validation\n\nTrain on all fields except one\n\nPredict the held-out field\n\nRepeat for each field\n\nRepresenting cases where producers lack prior field trials.",
    "crumbs": [
      "Tree Ensemble Prediction (2022)",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Overview</span>"
    ]
  },
  {
    "objectID": "01.Overview.html#findings-limitations",
    "href": "01.Overview.html#findings-limitations",
    "title": "1  Overview",
    "section": "Findings (Limitations)",
    "text": "Findings (Limitations)\nLOLO revealed:\n\nstrong within-field fit\n\nweak cross-field and cross-year performance\n\nReasons:\n\nSpatial instability: learned patterns do not transfer\n\nPoor extrapolation: unseen soil–weather combinations fail\n\nStatic predictors: SSURGO + DEM do not capture dynamic ground N and water interaction\nProcess mismatch: yield–N depends on nitrogen cycling, water stress, and crop growth\n\nThis motivated the transition to the Bayesian–APSIM approach used in later chapters.\n\n\n\n\n:::{#quarto-navigation-envelope .hidden}\n[Bayesian Yield–N Modeling]{.hidden .quarto-markdown-envelope-contents render-id=\"quarto-int-sidebar-title\"}\n[Bayesian Yield–N Modeling]{.hidden .quarto-markdown-envelope-contents render-id=\"quarto-int-navbar-title\"}\n[&lt;span class='chapter-number'&gt;2&lt;/span&gt;  &lt;span class='chapter-title'&gt;Economic Framework&lt;/span&gt;]{.hidden .quarto-markdown-envelope-contents render-id=\"quarto-int-next\"}\n[Preface]{.hidden .quarto-markdown-envelope-contents render-id=\"quarto-int-prev\"}\n[Preface]{.hidden .quarto-markdown-envelope-contents render-id=\"quarto-int-sidebar:/index.htmlPreface\"}\n[Tree Ensemble Prediction (2022)]{.hidden .quarto-markdown-envelope-contents render-id=\"quarto-int-sidebar:quarto-sidebar-section-1\"}\n[&lt;span class='chapter-number'&gt;1&lt;/span&gt;  &lt;span class='chapter-title'&gt;Overview&lt;/span&gt;]{.hidden .quarto-markdown-envelope-contents render-id=\"quarto-int-sidebar:/01.Overview.html&lt;span-class='chapter-number'&gt;1&lt;/span&gt;--&lt;span-class='chapter-title'&gt;Overview&lt;/span&gt;\"}\n[&lt;span class='chapter-number'&gt;2&lt;/span&gt;  &lt;span class='chapter-title'&gt;Economic Framework&lt;/span&gt;]{.hidden .quarto-markdown-envelope-contents render-id=\"quarto-int-sidebar:/02.Framework_Economics.html&lt;span-class='chapter-number'&gt;2&lt;/span&gt;--&lt;span-class='chapter-title'&gt;Economic-Framework&lt;/span&gt;\"}\n[&lt;span class='chapter-number'&gt;3&lt;/span&gt;  &lt;span class='chapter-title'&gt;Data and Design&lt;/span&gt;]{.hidden .quarto-markdown-envelope-contents render-id=\"quarto-int-sidebar:/03.Data_and_Experiment.html&lt;span-class='chapter-number'&gt;3&lt;/span&gt;--&lt;span-class='chapter-title'&gt;Data-and-Design&lt;/span&gt;\"}\n[&lt;span class='chapter-number'&gt;4&lt;/span&gt;  &lt;span class='chapter-title'&gt;Methods&lt;/span&gt;]{.hidden .quarto-markdown-envelope-contents render-id=\"quarto-int-sidebar:/04.Method.html&lt;span-class='chapter-number'&gt;4&lt;/span&gt;--&lt;span-class='chapter-title'&gt;Methods&lt;/span&gt;\"}\n[&lt;span class='chapter-number'&gt;5&lt;/span&gt;  &lt;span class='chapter-title'&gt;Results(limitation)&lt;/span&gt;]{.hidden .quarto-markdown-envelope-contents render-id=\"quarto-int-sidebar:/05.Results(Limitation).html&lt;span-class='chapter-number'&gt;5&lt;/span&gt;--&lt;span-class='chapter-title'&gt;Results(limitation)&lt;/span&gt;\"}\n[Bayesian-Hierarchical Analysis (2025)]{.hidden .quarto-markdown-envelope-contents render-id=\"quarto-int-sidebar:quarto-sidebar-section-2\"}\n[&lt;span class='chapter-number'&gt;6&lt;/span&gt;  &lt;span class='chapter-title'&gt;Overview(Bayesian)&lt;/span&gt;]{.hidden .quarto-markdown-envelope-contents render-id=\"quarto-int-sidebar:/06.Bayesian_Overview.html&lt;span-class='chapter-number'&gt;6&lt;/span&gt;--&lt;span-class='chapter-title'&gt;Overview(Bayesian)&lt;/span&gt;\"}\n[&lt;span class='chapter-number'&gt;7&lt;/span&gt;  &lt;span class='chapter-title'&gt;Bayesian Framework&lt;/span&gt;]{.hidden .quarto-markdown-envelope-contents render-id=\"quarto-int-sidebar:/07.Bayesian_Framework.html&lt;span-class='chapter-number'&gt;7&lt;/span&gt;--&lt;span-class='chapter-title'&gt;Bayesian-Framework&lt;/span&gt;\"}\n[&lt;span class='chapter-number'&gt;8&lt;/span&gt;  &lt;span class='chapter-title'&gt;Bayesian Method&lt;/span&gt;]{.hidden .quarto-markdown-envelope-contents render-id=\"quarto-int-sidebar:/08.Bayesian_Method.html&lt;span-class='chapter-number'&gt;8&lt;/span&gt;--&lt;span-class='chapter-title'&gt;Bayesian-Method&lt;/span&gt;\"}\n[&lt;span class='chapter-number'&gt;9&lt;/span&gt;  &lt;span class='chapter-title'&gt;Bayesian Results: Posterior Yield–N Curves and Economic Decisions&lt;/span&gt;]{.hidden .quarto-markdown-envelope-contents render-id=\"quarto-int-sidebar:/09.Bayesian_Results.html&lt;span-class='chapter-number'&gt;9&lt;/span&gt;--&lt;span-class='chapter-title'&gt;Bayesian-Results:-Posterior-Yield–N-Curves-and-Economic-Decisions&lt;/span&gt;\"}\n[Tree Ensemble Prediction (2022)]{.hidden .quarto-markdown-envelope-contents render-id=\"quarto-breadcrumbs-Tree-Ensemble-Prediction-(2022)\"}\n[&lt;span class='chapter-number'&gt;1&lt;/span&gt;  &lt;span class='chapter-title'&gt;Overview&lt;/span&gt;]{.hidden .quarto-markdown-envelope-contents render-id=\"quarto-breadcrumbs-&lt;span-class='chapter-number'&gt;1&lt;/span&gt;--&lt;span-class='chapter-title'&gt;Overview&lt;/span&gt;\"}\n:::\n\n\n\n:::{#quarto-meta-markdown .hidden}\n[[1]{.chapter-number}  [Overview]{.chapter-title} – Bayesian Yield–N Modeling]{.hidden .quarto-markdown-envelope-contents render-id=\"quarto-metatitle\"}\n[[1]{.chapter-number}  [Overview]{.chapter-title} – Bayesian Yield–N Modeling]{.hidden .quarto-markdown-envelope-contents render-id=\"quarto-twittercardtitle\"}\n[[1]{.chapter-number}  [Overview]{.chapter-title} – Bayesian Yield–N Modeling]{.hidden .quarto-markdown-envelope-contents render-id=\"quarto-ogcardtitle\"}\n[Bayesian Yield–N Modeling]{.hidden .quarto-markdown-envelope-contents render-id=\"quarto-metasitename\"}\n[]{.hidden .quarto-markdown-envelope-contents render-id=\"quarto-twittercarddesc\"}\n[]{.hidden .quarto-markdown-envelope-contents render-id=\"quarto-ogcardddesc\"}\n:::\n\n\n\n\n&lt;!-- --&gt;\n\n::: {.quarto-embedded-source-code}\n```````````````````{.markdown shortcodes=\"false\"}\n# Overview \n\n```{r setup, include=FALSE}\n\nknitr::opts_chunk$set(\n  message = FALSE,\n  warning = FALSE,\n  fig.align = \"center\",\n  fig.width = 7,\n  fig.height = 5,\n  dpi = 300\n)\n\nlibrary(here)\nlibrary(dplyr)\nlibrary(sf)\nlibrary(ggplot2)\n\nanalysis_dir &lt;- here::here(\"Data\", \"Processed\", \"Analysis_ready\")\n\nfield_centroids_sf &lt;- readRDS(file.path(analysis_dir, \"field_centroids_sf.rds\"))\n\nus_map_sf &lt;- sf::st_read(\n  here::here(\"Data\", \"Raw\", \"us_state_2023.shp\"),\n  quiet = TRUE\n) |&gt; sf::st_transform(4326)\n\nofpe_fips &lt;- c(17, 18, 19, 20, 21, 26, 27, 29, 31, 38, 39, 46, 55)\n\nofpe_states_sf &lt;- us_map_sf |&gt;\n  dplyr::rename_with(tolower) |&gt;\n  dplyr::filter(statefp %in% ofpe_fips) |&gt;\n  dplyr::mutate(fips = as.numeric(statefp)) |&gt;\n  dplyr::select(fips, stusps, geometry)",
    "crumbs": [
      "Tree Ensemble Prediction (2022)",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Overview</span>"
    ]
  },
  {
    "objectID": "01.Overview.html#background-1",
    "href": "01.Overview.html#background-1",
    "title": "1  Overview",
    "section": "Background",
    "text": "Background\n```{r fig1, echo=TRUE, cache=TRUE, fig.cap=“Figure 1. Location of OFPE fields across the Midwest U.S.”}\ncoords &lt;- sf::st_coordinates(field_centroids_sf)\nfield_points_public &lt;- field_centroids_sf |&gt; mutate( lon = coords[, “X”], lat = coords[, “Y”], lon_round = round(lon, 1), lat_round = round(lat, 1) ) |&gt; select(ffy_id, farm, field, year, stusps, lon_round, lat_round) |&gt; st_as_sf(coords = c(“lon_round”, “lat_round”), crs = 4326)\nfig1_field_loc &lt;- ggplot() + geom_sf(data = ofpe_states_sf, fill = “grey95”, color = “grey80”) + geom_sf( data = field_points_public, color = “black”, alpha = 0.15, size = 8, shape = 16 ) + theme_minimal() + coord_sf( xlim = range(sf::st_coordinates(ofpe_states_sf)[, 1]), ylim = range(sf::st_coordinates(ofpe_states_sf)[, 2]) ) + labs(x = NULL, y = NULL)\nfig1_field_loc\n\nThis figure shows the approximate locations of all OFPE fields used in the project.\nCoordinates are intentionally coarsened to protect field privacy and highlight only the\nspatial footprint and weather-diversity motivating the multi-field analysis.\n\n## Research Objectives {-}\n\nThe original objective was to use multi-field OFPE data to predict yield–nitrogen (yield–N)\nresponse at **new fields**, asking:\n\n- *Can yield–N responses at one field inform predictions at another?*  \n- *How transferable are empirical relationships across fields and years?*  \n- *Can purely data-driven ML models extract cross-field structure?*\n\nThese questions shaped the 2022 modeling strategy.\n\n## Method {-}\n\nThe 2022 analysis used **tree-ensemble models**:\n\n- Random Forests  \n- XGBoost  \n\nBy these model the yield($bu/ac$) of OFPE fields were trained on:\n\n- Nitrogen rate ($lbs/ac$) \n- SSURGO soil attributes^[Soil Survey Geographic Database (USDA NRCS)]  \n- DEM-derived^[Digital Elevation Model] topography  \n- In-season accumulated weather info (precipitation($mm$), GDD^[Growing Degree Days], EDD^[Extreme Degree Days] )\n\nWith generalization assessed via the cross-validation method:\n\n### Leave-One-Location-Out (LOLO) validation {-}\n\n1. Train on all fields *except* one  \n2. Predict the held-out field  \n3. Repeat for each field  \n\nRepresenting cases where producers lack prior field trials.\n\n## Findings (Limitations) {-}\n\nLOLO revealed:\n\n- strong **within-field** fit  \n- weak **cross-field** and **cross-year** performance  \n\nReasons:\n\n- **Spatial instability:** learned patterns do not transfer  \n- **Poor extrapolation:** unseen soil–weather combinations fail  \n- **Static predictors:** SSURGO + DEM do not capture dynamic ground N and water interaction \n- **Process mismatch:** yield–N depends on nitrogen cycling, water stress, and crop growth  \n\nThis motivated the transition to the **Bayesian–APSIM approach** used in later chapters.\n\n``````````````````` :::",
    "crumbs": [
      "Tree Ensemble Prediction (2022)",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Overview</span>"
    ]
  },
  {
    "objectID": "01.Overview.html#footnotes",
    "href": "01.Overview.html#footnotes",
    "title": "1  Overview",
    "section": "",
    "text": "Soil Survey Geographic Database (USDA NRCS)↩︎\nDigital Elevation Model↩︎\nGrowing Degree Days↩︎\nExtreme Degree Days↩︎",
    "crumbs": [
      "Tree Ensemble Prediction (2022)",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Overview</span>"
    ]
  },
  {
    "objectID": "02.Framework_Economics.html",
    "href": "02.Framework_Economics.html",
    "title": "2  Economic Framework",
    "section": "",
    "text": "Economic Framework\nOn-farm experiments (OFEs) have long been a cornerstone of agronomic research, providing structured, randomized trials to estimate crop yield responses to key inputs such as nitrogen (N). Their small plot size, however, limits the ability to capture spatial heterogeneity, which can bias estimates of the Economic Optimum Nitrogen Rate (EONR) when field variability is ignored Bullock et al. (2009); Anselin, Bongiovanni, and Lowenberg-DeBoer (2004). The emergence of On-Farm Precision Experiments (OFPEs) offers a scalable alternative. Using GPS-guided machinery, OFPEs introduce variable-rate nitrogen treatments across entire commercial fields, generating large spatial datasets that better reflect realistic production environments Bullock et al. (2019); Gebbers and Adamchuk (2010). This approach introduces new costs and risks for growers, because testing extreme nitrogen rates—particularly low or unprofitable levels—can expose farmers to revenue losses Lara et al. (2023), and multi-year replication is often required to capture the agronomic interactions between nitrogen, soil, and weather.\nWithin this setting, the central question is whether multi-field OFPE data can provide decision-relevant information for fields where no direct OFPE has been conducted. If the answer is positive, OFPE data generate positive informational externalities, enabling farmers to benefit from trials done on other fields. This possibility is especially important in the U.S. Corn Belt, where growers manage large areas but face logistical, financial, and risk-related barriers to running their own OFPEs. The economic framework developed here formalizes this question and provides a basis for evaluating the value of cross-field information.\nFollowing Bullock et al. (2009), crop yield \\(y\\) is modeled as \\[\ny = f(\\mathbf{x}, \\mathbf{c}, \\mathbf{z}),\n\\] where \\(\\mathbf{x}\\) denotes a vector of controllable inputs such as seed, fertilizer, herbicides, and hybrids; \\(\\mathbf{c}\\) collects field characteristics such as soil, organic matter, and topography; and \\(\\mathbf{z}\\) represents stochastic temporal variables such as weather and pest pressure. The full function \\(f(\\mathbf{x}, \\mathbf{c}, \\mathbf{z})\\) is referred to as nature’s meta-response function. For a specific field \\(i\\) with characteristic map \\(\\mathbf{c}_i\\), the site-specific response function is \\[\nf_i(\\mathbf{x}, \\mathbf{z}) \\equiv f(\\mathbf{x}, \\mathbf{c}_i, \\mathbf{z}),\n\\] which determines how yield responds to nitrogen under that field’s soil and topographic conditions.\nAssuming nitrogen is the only controllable input and prices \\(\\mathbf{p}\\) (crop) and \\(\\mathbf{w}\\) (N) are fixed, the farmer’s profit is \\[\n\\pi = \\mathbf{p}\\, f_i(N, \\mathbf{z}) - \\mathbf{w}\\, N.\n\\] Farmers face two conceptually distinct sources of uncertainty when choosing \\(N\\). First, weather events \\(\\mathbf{z} \\in Z\\) follow a climate distribution \\(h(\\mathbf{z})\\), but the realized \\(\\mathbf{z}\\) is not known ex ante. Second, farmers are uncertain about the true yield response function. They hold a subjective distribution \\(g(f_i^m \\mid \\eta)\\) over a finite set of possible response functions \\[\n\\Omega = \\{ f_i^1, \\ldots, f_i^M \\},\n\\] with the true function denoted \\(f_i^R\\). Here \\(\\eta\\) represents the available information. As information improves, beliefs become more concentrated, and \\(g(f_i^m \\mid \\eta)\\) tends toward one for \\(m=R\\), in the sense described by Laffont (1989).\nExpected maximum profit under information set \\(\\eta\\) is given by \\[\nE(\\pi_i \\mid \\eta)\n=\n\\max_N\n\\int_{z \\in Z}\n\\left\\{\n  \\sum_{m=1}^M\n  \\left[\n    \\mathbf{p}\\, f_i^m(N,\\mathbf{z}) - \\mathbf{w}\\, N\n  \\right]\n  g(f_i^m \\mid \\eta)\n\\right\\}\nh(\\mathbf{z}) \\, d\\mathbf{z},\n\\] which explicitly shows how the quality of information affects the nitrogen decision and the resulting expected profit.\nOFPEs provide information about the field-specific structure of \\(f_i(N,\\mathbf{z})\\), the interaction between applied nitrogen and soil or topographic features \\(\\mathbf{c}_i\\), and the way weather modifies nitrogen response. Given rich OFPE data on field \\(i\\), beliefs over the space of response functions can collapse toward the truth, so that \\[\ng(f_i^R \\mid \\eta^{\\prime}) = 1,\n\\] where \\(\\eta^{\\prime}\\) denotes information obtained from a single-field OFPE. However, if single-field OFPEs are infeasible, farmers may rely instead on benchmark information \\(\\eta^{\\prime}\\) from their own OFPE, when available, or on \\(\\eta^{\\prime\\prime}\\), which summarizes information from multi-field OFPE data. The key welfare comparison is \\[\n\\left|\n\\big[E(\\pi_i \\mid \\eta^{\\prime\\prime}) - E(\\pi_i \\mid \\eta^\\prime)\\big]\n-\n\\big[C(\\eta^{\\prime\\prime}) - C(\\eta^\\prime)\\big]\n\\right|,\n\\] where \\(E(\\pi_i \\mid \\eta^\\prime)\\) is expected profit using field-specific OFPE data, \\(E(\\pi_i \\mid \\eta^{\\prime\\prime})\\) is expected profit using cross-field information, and \\(C(\\eta)\\) denotes the cost of obtaining information set \\(\\eta\\). The empirical analysis asks whether \\(\\eta^{\\prime\\prime}\\) can approximate \\(\\eta^\\prime\\) in terms of decision quality, that is, whether multi-field OFPE data can provide nearly as much decision value as a field’s own OFPE.\nTo address this question, machine learning models such as XGBoost, Random Forest, and Causal Forest are used to predict the EONR for a given field based on data from other fields. The benchmark EONR, denoted \\(\\text{EONR}_d\\), is constructed ex post using generalized additive model (GAM)–based yield–nitrogen curves fitted to each field Wood (2017). The cross-field prediction, \\(\\text{EONR}_o\\), is obtained from models trained on multi-field OFPE data. Comparisons between \\(\\text{EONR}_o\\) and \\(\\text{EONR}_d\\) reveal large gaps, a lack of convergence across machine-learning methods, instability in predictions across price and weather regimes, and biological implausibility in some of the yield–nitrogen curves implied by cross-field predictions. These failures arise from the limited number of OFPE trials, which restricts weather and spatial diversity; from the static, low-resolution nature of soil and topographic covariates such as SSURGO and DEM; and from complex interactions among nitrogen, water, mineralization, and weather that are difficult for purely statistical models to capture.\nThe economic implication is that current multi-field OFPE data, when used with flexible machine-learning methods alone, are not yet a reliable substitute for a field’s own experiment. The framework developed here therefore motivates a transition to a Bayesian–APSIM approach, in which mechanistic crop models and regional yield histories are used to construct priors that can be coherently updated with OFPE data, offering a more robust basis for nitrogen decision support under uncertainty.\n\n\n\n\n\n\nAnselin, Luc, Rodolfo Bongiovanni, and Jess Lowenberg-DeBoer. 2004. “A Spatial Econometric Approach to the Economics of Site-Specific Nitrogen Management in Corn Production.” American Journal of Agricultural Economics 86 (3): 675–87.\n\n\nBullock, David S, Maria Boerngen, Haiying Tao, Bruce Maxwell, Joe D Luck, Luciano Shiratsuchi, Laila Puntel, and Nicolas F Martin. 2019. “The Data-Intensive Farm Management Project: Changing Agronomic Research Through on-Farm Precision Experimentation.” Agronomy Journal 111 (6): 2736–46.\n\n\nBullock, David S, Matı́as L Ruffo, Donald G Bullock, and Germán A Bollero. 2009. “The Value of Variable Rate Technology: An Information-Theoretic Approach.” American Journal of Agricultural Economics 91 (1): 209–23.\n\n\nGebbers, Robin, and Viacheslav I Adamchuk. 2010. “Precision Agriculture and Food Security.” Science 327 (5967): 828–31.\n\n\nLaffont, Jean-Jacques. 1989. Economie de l’incertain Et de l’information. Economica.\n\n\nLara, Alfonso de, Taro Mieno, Joe D Luck, and Laila A Puntel. 2023. “Predicting Site-Specific Economic Optimal Nitrogen Rate Using Machine Learning Methods and on-Farm Precision Experimentation.” Precision Agriculture, 1–21.\n\n\nWood, Simon N. 2017. Generalized Additive Models: An Introduction with r. Chapman; Hall/CRC.",
    "crumbs": [
      "Tree Ensemble Prediction (2022)",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Economic Framework</span>"
    ]
  },
  {
    "objectID": "02.Framework_Economics.html#yield-response-and-the-information-structure",
    "href": "02.Framework_Economics.html#yield-response-and-the-information-structure",
    "title": "2  Economic Framework",
    "section": "2. Yield Response and the Information Structure",
    "text": "2. Yield Response and the Information Structure\nFollowing Bullock et al. (2009), crop yield \\(y\\) is modeled as:\n\\[\ny = f(\\mathbf{x}, \\mathbf{c}, \\mathbf{z})\n\\tag{2.1}\\]\nwhere:\n\n\\(\\mathbf{x}\\) = vector of controllable inputs (seed, fertilizer, herbicides, hybrids),\n\n\\(\\mathbf{c}\\) = field characteristics (soil, organic matter, topography),\n\n\\(\\mathbf{z}\\) = stochastic temporal variables (weather, pests).\n\nThe full function\n\\[f(\\mathbf{x}, \\mathbf{c}, \\mathbf{z})\\]\nis referred to as nature’s meta-response function.\nFor a specific field \\(i\\) with characteristic map \\(\\mathbf{c}_i\\), the site-specific response function is:\n\\[\nf_i(\\mathbf{x}, \\mathbf{z}) \\equiv f(\\mathbf{x}, \\mathbf{c}_i, \\mathbf{z})\n\\]\nThis function determines how yield responds to nitrogen under that field’s soil and topographic conditions.",
    "crumbs": [
      "Tree Ensemble Prediction (2022)",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Economic Framework</span>"
    ]
  },
  {
    "objectID": "02.Framework_Economics.html#farmers-profit-maximization-problem",
    "href": "02.Framework_Economics.html#farmers-profit-maximization-problem",
    "title": "2  Economic Framework",
    "section": "3. Farmer’s Profit Maximization Problem",
    "text": "3. Farmer’s Profit Maximization Problem\nAssuming nitrogen is the only controllable input and prices \\(\\mathbf{p}\\) (crop) and \\(\\mathbf{w}\\) (N) are fixed, the farmer’s profit is:\n\\[\n\\pi = \\mathbf{p}\\, f_i(N, \\mathbf{z}) - \\mathbf{w}\\, N\n\\tag{2.2}\\]\nFarmers face two sources of uncertainty when choosing \\(N\\):\n\nWeather uncertainty.\nWeather events \\(\\mathbf{z} \\in Z\\) follow a known climate distribution \\(h(\\mathbf{z})\\), but farmers cannot know the realized \\(\\mathbf{z}\\) ex ante.\nUncertainty about the true yield response function.\nFarmers have a subjective distribution \\(g(f_i^m \\mid \\eta)\\) over the set of possible yield response functions\n\\[\\Omega = \\{ f_i^1, \\ldots, f_i^M \\}\\]\nwhere the true function is \\(f_i^R\\).\n\nMore information (denoted \\(\\eta\\)) sharpens this belief, causing\n\\[g(f_i^m \\mid \\eta) \\to 1 \\text{ for } m = R\\]\nas in Laffont (1989).\nThus, expected maximum profit under information \\(\\eta\\) is:\n\\[\nE(\\pi_i \\mid \\eta)\n=\n\\max_N\n\\int_{z \\in Z}\n\\left\\{\n  \\sum_{m=1}^M\n  \\left[\n    \\mathbf{p}\\, f_i^m(N,\\mathbf{z}) - \\mathbf{w}\\, N\n  \\right]\n  g(f_i^m \\mid \\eta)\n\\right\\}\nh(\\mathbf{z}) \\, d\\mathbf{z}\n\\tag{2.3}\\]\nThis expression is central: it shows how better information leads to better nitrogen decisions.",
    "crumbs": [
      "Tree Ensemble Prediction (2022)",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Economic Framework</span>"
    ]
  },
  {
    "objectID": "02.Framework_Economics.html#how-ofpe-data-provide-information",
    "href": "02.Framework_Economics.html#how-ofpe-data-provide-information",
    "title": "2  Economic Framework",
    "section": "4. How OFPE Data Provide Information",
    "text": "4. How OFPE Data Provide Information\nOFPEs reveal information about:\n\nthe field-specific structure of \\(f_i(N,\\mathbf{z})\\),\n\nthe interaction between applied N and soil/topographic features \\(\\mathbf{c}_i\\),\n\nthe way weather modifies nitrogen response.\n\nGiven OFPE data, beliefs collapse:\n\\[\ng(f_i^R \\mid \\eta^{\\prime}) = 1\n\\]\nwhere \\(\\eta^\\prime\\) denotes information from a single-field OFPE.\nHowever, if single-field OFPEs are infeasible, farmers may rely on:\n\n\\(\\eta^{\\prime}\\) = benchmark information (from own OFPE),\n\n\\(\\eta^{\\prime\\prime}\\) = information from multi-field OFPE data.\n\nThe relevant welfare comparison is:\n\\[\n\\left|\n\\big[E(\\pi_i \\mid \\eta^{\\prime\\prime}) - E(\\pi_i \\mid \\eta^\\prime)\\big]\n-\n\\big[C(\\eta^{\\prime\\prime}) - C(\\eta^\\prime)\\big]\n\\right|\n\\tag{2.4}\\]\nHere:\n\n\\(E(\\pi_i \\mid \\eta^\\prime)\\) = expected profit using field-specific OFPE data\n\n\\(E(\\pi_i \\mid \\eta^{\\prime\\prime})\\) = expected profit using cross-field information\n\n\\(C(\\eta)\\) = cost of obtaining information set \\(\\eta\\)\n\nThis study evaluates whether \\(\\eta^{\\prime\\prime}\\) can approximate \\(\\eta^\\prime\\) —\ni.e., whether multi-field OFPE data can provide nearly as much decision value as a field’s own OFPE.",
    "crumbs": [
      "Tree Ensemble Prediction (2022)",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Economic Framework</span>"
    ]
  },
  {
    "objectID": "02.Framework_Economics.html#why-multi-field-ofpe-predictions-fail-link-to-ml-results",
    "href": "02.Framework_Economics.html#why-multi-field-ofpe-predictions-fail-link-to-ml-results",
    "title": "2  Economic Framework",
    "section": "5. Why Multi-Field OFPE Predictions Fail (Link to ML Results)",
    "text": "5. Why Multi-Field OFPE Predictions Fail (Link to ML Results)\nUsing machine learning models (XGBoost, Random Forest, Causal Forest), we evaluate whether EONR predictions from other fields (EONR_o) approximate the benchmark EONR from the field’s own OFPE (EONR_d).\nEONR_d is constructed ex post using GAM-based yield–N curves fitted to each field (Wood 2017).\nResults reveal:\n\nLarge gaps between EONR_o and EONR_d\n\nNo convergence across ML methods\n\nInstability in predictions across price and weather regimes\n\nBiological implausibility in yield–N curves derived from cross-field predictions\n\nThese inconsistencies stem from:\n\nLimited number of OFPE trials → insufficient weather and spatial diversity\n\nStatic, low-resolution soil/topographic covariates (SSURGO, DEM)\n\nComplex interactions between N, water, mineralization, and weather\n\nMismatch between machine-learning predictors and underlying agronomic processes\n\nThus, current multi-field OFPE data are not yet a reliable substitute for a field’s own experiment.",
    "crumbs": [
      "Tree Ensemble Prediction (2022)",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Economic Framework</span>"
    ]
  },
  {
    "objectID": "03.Data_and_Experiment.html",
    "href": "03.Data_and_Experiment.html",
    "title": "3  Data and Design",
    "section": "",
    "text": "4 Data",
    "crumbs": [
      "Tree Ensemble Prediction (2022)",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Data and Design</span>"
    ]
  },
  {
    "objectID": "03.Data_and_Experiment.html#ofpe-dataset",
    "href": "03.Data_and_Experiment.html#ofpe-dataset",
    "title": "3  Data and Design",
    "section": "OFPE Dataset",
    "text": "OFPE Dataset\nOFPEs are designed as full-field, variable-rate input trials that assign controllable inputs—such as nitrogen (N) and seed rate—using spatially independent designs. To avoid confounding effects from correlated field characteristics, this study follows the DIFM (Data-Intensive Farm Management) experimental protocol, which ensures that the two trial inputs (seed and nitrogen) are orthogonally applied across spatial subplots within each field (Li, Mieno, and Bullock 2021). This design minimizes spatial correlation between inputs and unobserved field characteristics, allowing for credible estimation of input-specific yield response functions. An illustration of the field-level nitrogen application design used in the OFPE trials is shown in Figure 4.1.",
    "crumbs": [
      "Tree Ensemble Prediction (2022)",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Data and Design</span>"
    ]
  },
  {
    "objectID": "03.Data_and_Experiment.html#ofpe-n-rate-design-map",
    "href": "03.Data_and_Experiment.html#ofpe-n-rate-design-map",
    "title": "3  Data and Design",
    "section": "OFPE N-rate Design Map",
    "text": "OFPE N-rate Design Map\n\n\n\n\n\n\n\n\nFigure 4.1: Conceptual OFPE N-rate design map with five spatially independent N rates (100, 120, 160, 180, 200 lb N/ac).\n\n\n\n\n\nThe experimental units in an OFPE are polygonal subplots within a field, each receiving a unique combination of input rates. Trials are implemented using GPS-enabled tractors with variable-rate technology. During the growing season, data on input applications and environmental conditions are collected in real time, and yield data are recorded at harvest. Following collection, raw data are processed using DIFM protocols (Edge, Mieno, and Bullock 2024), which include cleaning for spatial misalignment, outlier removal, and exclusion of transition zones where input rates shift between plots. Input and yield values are then aggregated at the subplot level (using median values), and subplots with excessive deviation are removed to avoid contamination from spatial edge effects.\n\n\n\n\n\nStratification of OFPE data: yield outcome, manageable inputs (N, S), field-specific covariates (soil and topography), and spatio-temporal weather summaries.\n\n\n\n\nField-specific characteristics are added by overlaying each experimental polygon with spatial soil data from the SSURGO database (clay, sand, silt, and water storage) and topographic features derived from Digital Elevation Models (DEM)—including slope, curvature, and elevation. Climate variables—such as total in-season precipitation, growing degree days (GDD), and extreme degree days (EDD)—are retrieved from the Daymet weather dataset (Thornton et al. 2022). These additions allow us to account for both spatial and temporal sources of heterogeneity in the estimation of yield–N response functions. The full dataset includes 169 field-year OFPEs collected from 42 farms across eight Midwestern states between 2016 and 2023. After quality control, 95 field-year datasets from 33 farms were retained for this study.",
    "crumbs": [
      "Tree Ensemble Prediction (2022)",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Data and Design</span>"
    ]
  },
  {
    "objectID": "04.Method.html",
    "href": "04.Method.html",
    "title": "4  Methods",
    "section": "",
    "text": "This study evaluates whether multi-field machine-learning models can approximate field-specific nitrogen decisions that would otherwise require directly implementing an On-Farm Precision Experiment (OFPE). To do so, we construct yield–nitrogen response functions using a combination of Random Forest (RF), Extreme Gradient Boosting (XGBoost), and a leave-one-location-out (LOLO) cross-validation framework. These multi-field predictions are then compared to field-specific benchmark responses derived from a Generalized Additive Model (GAM) estimated using only the data from each individual OFPE field-year. The resulting comparison quantifies how closely pooled models replicate the nitrogen response, the economically optimal nitrogen rate (EONR), and the associated profit outcomes that would be obtained through direct experimentation.\nRandom Forest is employed as a flexible, nonparametric learning algorithm capable of capturing complex relationships between nitrogen, soils, and weather conditions across heterogeneous OFPE fields. The method builds an ensemble of regression trees using bootstrap samples and randomized feature selection, ensuring that each tree explores different partitions of the predictor space (Breiman (2001)). For a given observation \\(x_{ij}\\) representing nitrogen rate and associated covariates, the Random Forest prediction takes the form\n\\[\n\\hat{f}^{RF}(x_{ij}) = \\frac{1}{B} \\sum_{b=1}^B T_b(x_{ij}),\n\\]\nwhere \\(T_b(\\cdot)\\) denotes the prediction from tree \\(b\\). This averaging process reduces variance and allows the model to represent highly nonlinear and interaction-driven agronomic responses without specifying a parametric structure.\nExtreme Gradient Boosting (XGBoost) provides a complementary modeling strategy by constructing a sequence of regression trees, each of which is optimized to correct the errors of the preceding ensemble. Formally, the boosted prediction is expressed as\n\\[\n\\hat{f}^{XGB}(x_{ij}) = \\sum_{k=1}^{K} \\lambda_k T_k(x_{ij}),\n\\]\nwhere \\(T_k(\\cdot)\\) are regression trees and \\(\\lambda_k\\) are weights learned through gradient-based optimization (Chen and Guestrin (2016)). Regularization penalizes tree complexity and prevents overfitting, making XGBoost particularly effective for representing multivariate, nonlinear nitrogen response patterns in high-dimensional OFPE settings.\nTo ensure that model assessment reflects genuine out-of-field predictive performance, both RF and XGBoost are trained under a leave-one-location-out (LOLO) cross-validation design. Each “location” corresponds to a complete field-year (i.e., one OFPE implementation). In each iteration, all observations from a given field-year are removed from the training set, and the model is fitted using the remaining dataset. Predictions are then generated exclusively for the held-out field. For a field-year \\(i\\), this procedure produces yield predictions of the form\n\\[\n\\hat{Y}_{ij}^{(-i)} = \\hat{f}_{-i}(N_{ij}, X_{ij}),\n\\]\nwhere \\(\\hat{f}_{-i}\\) denotes the model trained on all other fields. This design prevents information leakage across subplot clusters within a field and provides a stringent test of how well multi-field relational patterns generalize to new farms under real-world agronomic heterogeneity.\nModel evaluation requires a benchmark representation of the realized yield–nitrogen relationship in each field. This benchmark is derived from a Generalized Additive Model (GAM) estimated using only the subplot-level data from the field-year under consideration. The GAM specification introduces smooth terms for nitrogen and key environmental covariates, enabling flexible representation of the underlying response surface without assuming linearity or functional restrictions. For field-year \\(i\\), the benchmark response function is given by\n\\[\n\\hat{f}^{GAM}_{i}(N, X) =\n\\beta_0\n+ s_1(N) + s_2(\\text{SED}) + s_3(\\text{Slope})\n+ s_4(\\text{Elevation}) + s_5(\\text{Clay})\n+ s_6(\\text{Sand}) + s_7(\\text{Silt}) + \\varepsilon,\n\\]\nwhere \\(s_1, \\dots, s_7\\) denote smooth functions estimated from the field’s own observations (Wood (2017); Gardner, Mieno, and Bullock (2021); Hegedus, Maxwell, and Mieno (2023)). This single-field GAM serves as the ex post yield–nitrogen curve realized under the actual soil, weather, and management conditions of that field-year.\nUsing the GAM-estimated yield curve as the realized crop production function, economic outcomes are calculated by combining predicted yield with observed price and nitrogen cost information. The profit associated with nitrogen rate \\(N\\) in field \\(i\\) is\n\\[\n\\pi_i(N) = \\bar{p}\\,\\hat{f}^{GAM}_i(N) - \\bar{w}\\,N,\n\\]\nwhere \\(\\bar{p}\\) is the corn price and \\(\\bar{w}\\) is the per-unit nitrogen cost. The economically optimal nitrogen rate derived from direct OFPE data is then\n\\[\nEONR_d = \\arg\\max_N \\pi_i(N),\n\\]\nproviding a field-specific benchmark that reflects the true profit-maximizing decision for that year.\nMulti-field machine-learning models generate analogous profit functions using predictions from LOLO-trained models. For method \\(ML \\in \\{RF, XGB\\}\\), the predicted profit for field \\(i\\) is\n\\[\n\\pi^{ML}_i(N) = \\bar{p}\\,\\hat{f}^{ML}_{-i}(N) - \\bar{w}\\,N,\n\\]\nand the corresponding optimal nitrogen rate is\n\\[\nEONR_o = \\arg\\max_N \\pi^{ML}_i(N).\n\\]\nComparing \\(EONR_o\\) to \\(EONR_d\\) reveals the accuracy with which multi-field learning can substitute for direct experimentation. Differences in predicted and benchmark nitrogen rates are evaluated alongside differences in profit outcomes. The economic discrepancy,\n\\[\n\\Delta \\pi_i = \\pi_i(EONR_o) - \\pi_i(EONR_d),\n\\]\nsummarizes whether relying on pooled information leads to revenue gains or losses relative to the field-specific optimum. These comparisons allow us to determine both the predictive validity and the economic relevance of transferring information across OFPE fields, providing a direct empirical test of whether multi-field data can approach the decision quality generated by site-specific experiments.\n\n\n\n\n\n\nBreiman, Leo. 2001. “Random Forests.” Machine Learning 45 (1): 5–32.\n\n\nChen, Tianqi, and Carlos Guestrin. 2016. “Xgboost: A Scalable Tree Boosting System.” In Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining, 785–94.\n\n\nGardner, Grant, Taro Mieno, and David S Bullock. 2021. “An Economic Evaluation of Site-Specific Input Application r x Maps: Evaluation Framework and Case Study.” Precision Agriculture 22: 1304–16.\n\n\nHegedus, Paul B, Bruce D Maxwell, and Taro Mieno. 2023. “Assessing Performance of Empirical Models for Forecasting Crop Responses to Variable Fertilizer Rates Using on-Farm Precision Experimentation.” Precision Agriculture 24 (2): 677–704.\n\n\nWood, Simon N. 2017. Generalized Additive Models: An Introduction with r. Chapman; Hall/CRC.",
    "crumbs": [
      "Tree Ensemble Prediction (2022)",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Methods</span>"
    ]
  },
  {
    "objectID": "05.Results(Limitation).html",
    "href": "05.Results(Limitation).html",
    "title": "5  Results(limitation)",
    "section": "",
    "text": "To demonstrate the limits of transferring information across OFPE fields, we focus on one representative field that has three replicated OFPE trials conducted over multiple years within a standard crop rotation. This field is not special within the dataset; rather, it is chosen because it contains repeated experiments under comparable management, making it an ideal example of the general patterns observed across the entire sample. Variable-importance profiles and decision-tree structures for all other fields exhibit nearly identical behaviors and are reported in the Appendix.\nFigure Figure 5.1 shows the variable-importance patterns obtained from Random Forest and XGBoost when the chosen field is excluded from the training set under leave-one-location-out (LOLO) cross-validation. Because LOLO removes only the target field in each iteration, and because all other fields remain in the training sample, the training data are nearly identical across years. This results in highly stable variable-importance rankings, which is precisely what we observe. Both RF and XGBoost consistently assign dominant importance to growing degree days, elevation, extreme degree days, and total seasonal precipitation. Soil texture and water-storage variables follow, while nitrogen rate receives only modest importance.\nThis pattern reflects a structural feature of the pooled OFPE dataset: most between-field variation in observed yields arises from differences in weather, landscape position, and long-run soil properties, rather than from differences in applied nitrogen rates. Consequently, the models learn that nitrogen plays a relatively small role in explaining the broad cross-field variation. While such rankings are reasonable for predicting average yields across diverse environments, they already signal a key limitation for nitrogen recommendation: the models place limited emphasis on nitrogen when learning from the multi-field dataset, making it difficult to recover field-specific curvature in the yield$–N response when predicting for an unseen field.\n\n\n\n\n\n\n\n\nFigure 5.1: Variable importance obtained from Random Forest (top row) and XGBoost (bottom row) under leave-one-location-out training for one representative field. Importance values are scaled within method. The dominant roles of weather, elevation, and site characteristics—and the consistently low weight placed on nitrogen rate—reflect the structure of the pooled multi-field dataset.\n\n\n\n\n\nFurther insight into how the model internalizes these relationships is provided by the first decision tree in the XGBoost ensemble for each of the three replicated trial years (Figures Figure 5.2–Figure 5.4). Across all years, the tree begins with splits on elevation and precipitation, followed by growing degree days; only deeper in the tree do soil properties or nitrogen rate appear. The structure is strikingly similar across all replications, which is expected because the LOLO procedure uses almost the same training set for each year. This stability indicates that the model is not adapting to the specific nitrogen–yield structure of the unseen field-year; instead, it relies on a general, weather-and-topography-dominated partition learned from the pooled dataset. Although this representation predicts average yield levels reasonably well, it offers little sensitivity to within-field nitrogen variation—the key requirement for recovering a meaningful nitrogen response.\n\n\n\n\n\n\n\n\nFigure 5.2: Decision tree from the XGBoost ensemble for the first replicated trial year in the example field. The tree splits primarily on elevation and seasonal precipitation, demonstrating that the model prioritizes environmental gradients over nitrogen when trained on pooled multi-field data.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5.3: XGBoost decision tree for the second replicated trial year. The structure remains nearly identical to the first year, reflecting the fact that under leave-one-location-out cross-validation the training data are almost unchanged across years and that the model consistently relies on weather–topography partitions.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5.4: XGBoost decision tree for the third replicated trial year. Despite crop rotation and differing weather conditions, the primary splits again emphasize elevation, precipitation, and growing degree days, illustrating the model’s limited sensitivity to nitrogen rate in unseen field-years.\n\n\n\n\n\nThe limitations of relying on pooled data for nitrogen recommendations become clearest when examining the predicted yield–nitrogen curves. Figure Figure 5.5 shows the relationship between nitrogen rate and predicted yield for each trial year, comparing the LOLO-trained Random Forest and XGBoost predictions to the field-specific GAM curve estimated from the direct OFPE data. The GAM curves exhibit smooth and interpretable nitrogen responses that differ across years—sometimes showing a clear interior optimum, other times flattening over a wide interval. These differences reflect real variation in weather, soil moisture, and rotational effects.\nIn contrast, the LOLO-trained machine-learning curves are almost entirely insensitive to nitrogen. Both RF and XGBoost produce step-like or nearly flat yield predictions across the nitrogen range, a direct consequence of nitrogen’s low importance and minimal representation in the tree structures. As a result, the models are unable to recover the curvature of the yield–N response and often push the predicted EONR toward the boundary of the observed N range or leave it essentially unidentified. This mismatch between predicted and realized nitrogen responses is not unique to this example field; similar discrepancies appear across the full set of fields, confirming that the multi-field models fail to transfer actionable nitrogen information to unseen locations.\n\n\n\n\n\n\n\n\nFigure 5.5: Yield–nitrogen response curves for three replicated trial years in the example field. Red lines represent the field-specific GAM response estimated from the direct OFPE data; green and blue lines represent Random Forest and XGBoost predictions under leave-one-location-out training. The multi-field models capture average yield levels but fail to reproduce the field-year-specific curvature of the nitrogen response, leading to boundary or poorly identified EONR estimates.\n\n\n\n\n\nTaken together, these findings show that cross-field machine-learning models trained under LOLO cross-validation explain substantial variation in average yield levels across farms but do not deliver transferable nitrogen-response information. The models consistently prioritize environmental gradients—weather, elevation, and stable soil attributes—which dominate cross-field variation. Nitrogen, being relatively small in its contribution to pooled predictive accuracy, receives minimal attention in the learned structures. As a result, although the models generalize well in terms of yield prediction, they fail to generalize in the dimension that matters for nitrogen management: the shape and slope of the yield–N response curve. The full set of fields analyzed in the Appendix reveals the same qualitative behavior, indicating that this limitation is systemic rather than field-specific.\n\n\n\n\nTable 5.1: Comparison of the estimated economically optimal nitrogen rates (EONR) and profits across GAM(from direct OFPE data), Random Forest, and XGBoost (trained) models for fields with three replicated OFPE trials. Values are scenario-averaged for each field-year, highlighting how multi-field machine learning models diverge from field-specific GAM benchmarks.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nComparison of EONR and profit across models for three-trial fields\n\n\nField\nField-year\n\nEconomically optimal N rate (lb N/ac)\n\n\nProfit at EONR ($/ac)\n\n\n\nGAM EONR\nRF EONR\nXGB EONR\nGAM Profit\nRF Profit\nXGB Profit\n\n\n\n\n23_2\n23_2_2018\n155\n146\n165\n1,091\n1,073\n1,059\n\n\n23_2\n23_2_2020\n201\n159\n165\n1,078\n1,068\n1,111\n\n\n23_2\n23_2_2022\n164\n152\n162\n1,057\n1,042\n1,090\n\n\n23_3\n23_3_2017\n164\n161\n171\n1,037\n905\n791\n\n\n23_3\n23_3_2019\n210\n160\n166\n775\n1,008\n1,014\n\n\n23_3\n23_3_2021\n196\n158\n171\n904\n984\n957\n\n\n28_5\n28_5_2018\n142\n123\n105\n1,111\n1,053\n1,069\n\n\n28_5\n28_5_2020\n183\n139\n135\n995\n1,058\n1,097\n\n\n28_5\n28_5_2022\n172\n145\n149\n1,197\n1,065\n1,092\n\n\n36_3\n36_3_2016\n160\n165\n173\n1,020\n1,040\n1,016\n\n\n36_3\n36_3_2018\n204\n190\n193\n1,171\n994\n1,010\n\n\n36_3\n36_3_2020\n192\n156\n156\n1,075\n1,068\n1,071\n\n\n3_1\n3_1_2016\n166\n160\n165\n636\n651\n579\n\n\n3_1\n3_1_2018\n207\n160\n170\n816\n797\n830\n\n\n3_1\n3_1_2020\n179\n116\n153\n590\n800\n630\n\n\n3_2\n3_2_2016\n159\n149\n184\n480\n585\n560\n\n\n3_2\n3_2_2018\n195\n167\n179\n890\n676\n683\n\n\n3_2\n3_2_2020\n123\n123\n168\n657\n718\n651\n\n\n40_1\n40_1_2017\n198\n170\n165\n1,011\n914\n1,015\n\n\n40_1\n40_1_2019\n259\n152\n168\n947\n950\n1,025\n\n\n40_1\n40_1_2021\n259\n176\n181\n1,127\n941\n985\n\n\n\n\n\n\n\n\n\n\nTable Table 5.1 summarizes the economically optimal nitrogen rates (EONR) and associated profits across all fields with three replicated OFPE trials, comparing the direct field-specific GAM benchmark to the RF and XGBoost models trained under leave-one-location-out. For each field-year, the table reports the mean EONR and the corresponding profit at that EONR under each model, averaged across the price scenarios used in the simulation. A clear pattern emerges from these comparisons: the EONR values predicted by RF and XGBoost frequently diverge substantially from the GAM benchmarks, often falling either well below or well above the field-specific optimum. This systematic mismatch provides direct evidence that the multi-field models, when trained on pooled data, fail to internalize the nitrogen-yield structure relevant for a new, unseen field. In other words, despite strong performance in predicting average yield levels, the RF and XGBoost models offer little transferable information about economically meaningful nitrogen responses, reinforcing the broader limitation documented throughout this section.",
    "crumbs": [
      "Tree Ensemble Prediction (2022)",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Results(limitation)</span>"
    ]
  },
  {
    "objectID": "06.Bayesian_Overview.html",
    "href": "06.Bayesian_Overview.html",
    "title": "6  Overview(Bayesian)",
    "section": "",
    "text": "Background\nOn-farm precision experiments (OFPE) generate dense yield data across a wide range of nitrogen (N) rates on individual commercial fields. At first glance, this appears ideal for directly estimating a field’s yield–N relationship and using machine-learning algorithms to choose an economically optimal N rate. Yet the earlier ensemble-model analysis revealed a deeper structural issue: the observed yield is shaped by a highly complex interaction between nitrogen, soils, landscape variation, drainage, and intra-annual weather. A single OFPE year captures only one realization of that joint system, and even two years rarely span meaningful weather diversity. Machine-learning models fit these data well in-sample but fail to generalize across years and fields because the signal is thin and overwhelmed by field-specific noise.\nTherefore, the question is not whether OFPE can deliver perfect forecasts. It cannot. The more relevant question is how OFPE can be used together with broader and more stable information sources—APSIM simulations, long-run county yield histories, and regional production trends—to help farmers form more coherent and more defensible beliefs about their field’s yield–N curve as years accumulate.\nThe shift in perspective is fundamental. Instead of treating one or two OFPE years as a full estimator of the response function, OFPE should be viewed as incremental evidence that complements a larger information structure already available to the farmer.",
    "crumbs": [
      "Bayesian-Hierarchical Analysis (2025)",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Overview(Bayesian)</span>"
    ]
  },
  {
    "objectID": "06.Bayesian_Overview.html#information-structure-apsim-ofpe-and-regional-yield-trends",
    "href": "06.Bayesian_Overview.html#information-structure-apsim-ofpe-and-regional-yield-trends",
    "title": "6  Overview(Bayesian)",
    "section": "Information Structure: APSIM, OFPE, and Regional Yield Trends",
    "text": "Information Structure: APSIM, OFPE, and Regional Yield Trends\nThe map below introduces this structure. OFPE fields (black points) lie within APSIM simulation cells (colored polygons), each representing a 30-year distribution of yields over agronomic and weather variability.\n\np_combined\n\n\n\n\nFigure 1. Information structure of APSIM and OFPE data at Illinois\n\n\n\n\nThis spatial structure matters because APSIM provides a stable representation of long-run biophysical behavior, while OFPE provides short-run, field-specific realizations. The combination of these two sources is the foundation of Bayesian updating.\nTo illustrate their divergence, it is helpful to also look at the panel of OFPE–APSIM curve comparisons for 2023, shown below. These figures highlight the empirical challenge: OFPE responses differ across fields and weather states, and APSIM’s long-run mean often lies below observed yields at low N rates, partly because recent genetic gains and modern management have increased yield potential faster than calibrated crop models typically reflect.\n\nknitr::include_graphics(file.path(book_figure_bayes2_dir, \"apsim_ofpe_curves_2023.pdf\"))\n\n\n\n\nFigure 2. OFPE, APSIM and regional average yield comparison in 2023\n\n\n\n\nThe pattern shown here—APSIM underestimating low-N yields in some years, OFPE curves differing sharply even within the same region, and substantial within-N yield variation—underscores the need for a framework that neither over-reacts to one noisy trial nor blindly relies on long-run simulation outputs.",
    "crumbs": [
      "Bayesian-Hierarchical Analysis (2025)",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Overview(Bayesian)</span>"
    ]
  },
  {
    "objectID": "06.Bayesian_Overview.html#why-a-bayesian-perspective-is-needed-now",
    "href": "06.Bayesian_Overview.html#why-a-bayesian-perspective-is-needed-now",
    "title": "6  Overview(Bayesian)",
    "section": "Why a Bayesian Perspective Is Needed Now",
    "text": "Why a Bayesian Perspective Is Needed Now\nFrom a decision-making standpoint, a farmer must choose N before observing the growing season, based on uncertain beliefs about the yield–N function. Three realities make Bayesian updating appropriate.\nFirst, OFPE alone cannot be treated as a full estimator of the response curve. With only one or two years of data and large within-N variance, relying exclusively on OFPE produces overfitting: the yield–N curve inferred from a single season is too tightly tied to that year’s weather and idiosyncratic field conditions.\nSecond, APSIM alone cannot be treated as the truth either. While APSIM encodes agronomic knowledge and long-run climate variability, it can systematically misrepresent the level and curvature of field-level responses. This leads to under-fitting: the recommendations based solely on APSIM may ignore persistent field-specific deviation from the regional or simulated pattern.\nThird, county-level historical yield trends offer information about regional production trajectories, but not about the curvature of yield–N relationships. They tell us how yield potential has shifted over time due to genetics or management, and thus provide context for calibrating and interpreting APSIM priors. For example, when regional yields consistently exceed APSIM mid-range predictions, this discrepancy informs how the prior should be interpreted and why OFPE deviations are not surprising.\nA Bayesian perspective provides a disciplined way to combine these imperfect sources. However, with only one or two OFPE years available today, the posterior should not be interpreted as a finalized “answer.” Instead, it should be viewed as a framework for long-run learning, designed so that sequential OFPE seasons—accumulated over time or across producers—can gradually refine the field-specific beliefs.",
    "crumbs": [
      "Bayesian-Hierarchical Analysis (2025)",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Overview(Bayesian)</span>"
    ]
  },
  {
    "objectID": "06.Bayesian_Overview.html#using-ofpe-in-a-long-term-decision-framework",
    "href": "06.Bayesian_Overview.html#using-ofpe-in-a-long-term-decision-framework",
    "title": "6  Overview(Bayesian)",
    "section": "Using OFPE in a Long-Term Decision Framework",
    "text": "Using OFPE in a Long-Term Decision Framework\nThe role of OFPE in this study is therefore not to produce an immediate, sharply defined posterior curve, but to serve as the basis for a cumulative learning process. Even two replicated trials on the same field can already reveal important economic structure: whether the field consistently sits above or below its regional trend; whether the yield–N shape is stable or highly sensitive to weather; and whether the APSIM prior consistently over- or under-predicts the observed range.\nOver time, OFPE provides a slow but informative sequence of signals. APSIM provides the broad envelope of plausible responses. County yield histories provide temporal context and calibration. Together they constitute a hierarchy of evidence that supports a farmer’s evolving beliefs.\nThe objective of the Bayesian chapters in this book is to establish this structure—not to assert that the current posterior is sufficiently precise, but to define the mechanism through which accumulating OFPE data will eventually yield more reliable and more profitable nitrogen decisions.",
    "crumbs": [
      "Bayesian-Hierarchical Analysis (2025)",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Overview(Bayesian)</span>"
    ]
  },
  {
    "objectID": "07.Bayesian_Framework.html",
    "href": "07.Bayesian_Framework.html",
    "title": "7  Bayesian Framework",
    "section": "",
    "text": "Bayesian Framework\nA fundamental challenge in learning nitrogen–yield response functions from on-farm precision experiments (OFPE) is that each field typically provides only one or two years of observations, a limitation widely noted in agronomic experimentation and on-farm trial design Bullock, Boerngen, et al. (2019); Mieno et al. (2022). Although these trials generate thousands of spatially rich subplot measurements within a season, the information comes from a single realization of weather. Let \\(N\\) denote the nitrogen rate (lb/ac), and let \\(Y(N)\\) denote the stochastic yield generated by agronomic and climatic processes. The long-run distribution of interest is\n\\[\nF^\\star(y \\mid N) = \\Pr(Y(N) \\le y),\n\\]\nwhich governs the uncertainty a farmer must confront when making nitrogen decisions Antle (1983); Just and Pope (1990). Profit at rate \\(N\\) is\n\\[\n\\pi(N) = p_y\\,Y(N) - p_n\\,N,\n\\]\nand a risk-neutral farmer chooses\n\\[\nN^\\star = \\arg\\max_N \\left\\{ p_y\\,\\mathbb{E}[Y(N)] - p_n N \\right\\}.\n\\]\nAccurate decision making therefore depends on forming a predictive distribution that reflects the long-run variability of weather and soil interactions rather than the particular conditions observed in a single year of experimentation. An OFPE mean in year \\(t\\) can be interpreted as\n\\[\n\\bar{Y}(N) \\approx Y(N)\\,\\big|\\,W_t,\n\\]\nwhere \\(W_t\\) is the realized weather of that season. Even two years of data provide only two realizations of \\(W_t\\), which is insufficient to approximate the full distribution \\(F^\\star(y\\mid N)\\) or to reveal the curvature of the underlying nitrogen response function. Consequently, methods that rely solely on OFPE data—such as direct estimation or machine-learning prediction—tend to overfit the realized weather state and fail to generalize across years or fields Mendonça (2023); Mieno et al. (2022).\nThe Bayesian framework resolves this limitation by integrating OFPE data with two additional sources of information. The APSIM crop model produces multi-decade simulations that encode agronomic relationships among nitrogen, soil, and weather Holzworth et al. (2014). For each nitrogen rate, APSIM yields a distribution characterized by prior moments\n\\[\n\\mu_{1,0}(N), \\qquad \\mu_{2,0}(N), \\qquad \\mu_{3,0}(N),\n\\]\nwhich summarize the mean, variance, and third central moment implied by long-run simulated climate sequences. These moments define a prior density\n\\[\nf_0(y \\mid N),\n\\]\nwhich is informative about long-run behavior but not tailored to any particular field. County-level yield histories add information about regional technological trends and recent climatic anomalies, allowing the prior to reflect the broader environment in which each OFPE trial is conducted Naderi et al. (2020); NASS (2024).\nAgainst this prior background, OFPE data provide likelihood information about the field-specific mean yield. For nitrogen rate \\(N_k\\) with \\(n_k\\) subplot measurements, the sample mean satisfies\n\\[\n\\bar{Y}_k \\mid \\mu_1(N_k)\n\\sim\n\\mathcal{N}\\!\\left(\\mu_1(N_k),\\,\\frac{\\sigma^2(N_k)}{n_k}\\right),\n\\]\nfollowing standard sampling theory for subplot-scale agronomic experiments Casella and Berger (2002); Gelman et al. (2013). Because each subplot is small, the sample mean offers a precise measurement of the seasonal average, but only for the weather state actually realized in that year. To reconcile long-run prior information with year-specific evidence, the unknown field-level mean \\(\\mu_1(N)\\) is assigned a prior distribution\n\\[\n\\mu_1(N) \\sim \\mathcal{N}\\!\\left(m_0(N),\\,v_0(N)\\right),\n\\]\nwhere \\(m_0(N)=\\mu_{1,0}(N)\\) and \\(v_0(N)\\) reflects uncertainty in how well APSIM represents the field. Conditioning on the OFPE mean yields the posterior distribution\n\\[\n\\mu_1(N) \\mid \\bar{Y}(N)\n\\sim\n\\mathcal{N}\\!\\left(m_1(N),\\,v_1(N)\\right),\n\\]\nwhere\n\\[\nv_1(N)\n=\n\\left[\n\\frac{1}{v_0(N)} + \\frac{n(N)}{\\sigma^2(N)}\n\\right]^{-1},\n\\]\nand\n\\[\nm_1(N)\n=\nv_1(N)\\left[\n\\frac{m_0(N)}{v_0(N)}\n+\n\\frac{n(N)\\bar{Y}(N)}{\\sigma^2(N)}\n\\right].\n\\]\nThe structure of these expressions illustrates how Bayesian learning balances long-run agronomic information with short-run field evidence, consistent with general Bayesian estimation principles in hierarchical modeling Gelman et al. (2013). When the OFPE experiment contains many subplots, the observed mean provides strong information about the yield level for that specific season, but the prior prevents the estimate from drifting too far from the distribution implied by multi-decade simulations. Conversely, when only one or two seasons of OFPE data are available, the posterior remains anchored near the prior because limited weather realizations cannot reveal the underlying response curve. Over time, as additional OFPE years accumulate, the posterior shifts progressively toward the field’s true long-run distribution.\nTo support nitrogen decisions, the posterior distribution of the mean must be translated into a posterior predictive distribution for yields. Conceptually, this is obtained from\n\\[\nf_{\\text{post}}(y \\mid N)\n=\n\\int f(y \\mid \\mu_1(N)) \\,\np(\\mu_1(N) \\mid \\text{data}) \\,\nd\\mu_1(N),\n\\]\na mixture distribution combining uncertainty about the long-run mean with within-year stochastic variation. In practice, this predictive distribution is represented using a maximum-entropy density that matches the posterior mean, posterior variance, and third central moment, following classical moment-based maximum-entropy methods Jaynes (1957a); Jaynes (1957b).\nThe Bayesian structure therefore establishes a long-term decision-support mechanism. Each year of OFPE data contributes incrementally to the understanding of field-level nitrogen response, while APSIM simulations and regional histories provide the broader context needed to interpret those observations. The result is a coherent learning system: even with limited OFPE data today, the framework ensures that all available knowledge is combined efficiently, and as OFPE seasons accumulate, the posterior predictive distribution becomes increasingly field-specific. In this way, Bayesian updating converts sparse short-run experiments into a cumulative learning process capable of guiding nitrogen decisions under uncertainty.\n\n\n\n\n\n\nAntle, John M. 1983. “Testing the Stochastic Structure of Production: A Flexible Moment-Based Approach.” American Journal of Agricultural Economics.\n\n\nBullock, David, Mikel Boerngen, et al. 2019. “The Data-Intensive Farm Management Project: Designing on-Farm Experiments.” Agricultural Systems.\n\n\nCasella, George, and Roger Berger. 2002. Statistical Inference. Duxbury Press.\n\n\nGelman, Andrew, John Carlin, Hal Stern, David Dunson, Aki Vehtari, and Donald Rubin. 2013. Bayesian Data Analysis. 3rd ed. CRC Press.\n\n\nHolzworth, Dean P, Neil I Huth, Peter G deVoil, Eric J Zurcher, Neville I Herrmann, Greg McLean, Karine Chenu, et al. 2014. “APSIM–Evolution Towards a New Generation of Agricultural Systems Simulation.” Environmental Modelling & Software 62: 327–50.\n\n\nJaynes, Edwin T. 1957a. “Information Theory and Statistical Mechanics.” Physical Review 106: 620–30.\n\n\n———. 1957b. “Information Theory and Statistical Mechanics II.” Physical Review 108: 171–90.\n\n\nJust, Richard E, and Rulon D Pope. 1990. “Studies in the Demand for Risky Inputs.” American Journal of Agricultural Economics.\n\n\nMendonça, et al. 2023. “Modeling Nitrogen Response with Weather and Soil Interactions.” Agronomy Journal.\n\n\nMieno, Taro et al. 2022. “Learning from on-Farm Precision Experiments: Estimating Field-Specific Nitrogen Response.” American Journal of Agricultural Economics.\n\n\nNaderi, Amir et al. 2020. “Long-Run Trends in County-Level Maize Yields.” Field Crops Research.\n\n\nNASS, USDA. 2024. “National Agricultural Statistics Service (NASS): Historical Yield Data.”",
    "crumbs": [
      "Bayesian-Hierarchical Analysis (2025)",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Bayesian Framework</span>"
    ]
  },
  {
    "objectID": "08.Bayesian_Method.html",
    "href": "08.Bayesian_Method.html",
    "title": "8  Bayesian Method",
    "section": "",
    "text": "Bayesian Method\nThe Bayesian method operationalizes the conceptual framework by specifying how prior information, OFPE data, and probabilistic updating are combined into a predictive distribution for yields at each nitrogen rate. Let \\(N\\) denote the nitrogen rate and \\(Y(N)\\) the corresponding random yield. Prior information comes from APSIM simulations and regional yield histories, both of which help characterize long-run agronomic outcomes under alternative nitrogen regimes Holzworth et al. (2014); Naderi et al. (2020). This information is summarized through the first three moments, \\[\n\\mu_{1,0}(N), \\qquad \\mu_{2,0}(N), \\qquad \\mu_{3,0}(N),\n\\] representing the prior mean, variance, and third central moment. These moments define the prior density \\(f_0(y \\mid N)\\), which provides an informative but imperfect representation of field-level yield behavior.\nTo incorporate field evidence, the OFPE design assigns multiple subplots to each nitrogen rate Bullock, Boerngen, et al. (2019); Mieno et al. (2022). Suppose that rate \\(N_k\\) is applied to \\(n_k\\) subplots with yields \\(\\{Y_{k1},\\dots,Y_{k n_k}\\}\\). The sample mean, \\[\n\\bar{Y}_k = \\frac{1}{n_k}\\sum_j Y_{kj},\n\\] is treated as a noisy measurement of the underlying field-specific mean yield \\(\\mu_1(N_k)\\). Under standard sampling assumptions for subplot-scale agronomic experiments Casella and Berger (2002), the corresponding likelihood is \\[\n\\bar{Y}_k \\mid \\mu_1(N_k)\n\\sim\n\\mathcal{N}\\!\\left(\\mu_1(N_k),\\,\\frac{\\sigma^2(N_k)}{n_k}\\right),\n\\] which reflects the high precision of subplot means within a year but only for the weather state realized during the trial.\nThe prior distribution for \\(\\mu_1(N)\\) is specified as \\[\n\\mu_1(N) \\sim \\mathcal{N}\\!\\left(m_0(N),\\,v_0(N)\\right),\n\\] where \\(m_0(N)\\) equals the APSIM-derived prior mean \\(\\mu_{1,0}(N)\\) and \\(v_0(N)\\) formalizes uncertainty about how well APSIM approximates field conditions. The Normal–Normal conjugacy Gelman et al. (2013) yields the posterior distribution \\[\n\\mu_1(N) \\mid \\bar{Y}(N)\n\\sim\n\\mathcal{N}\\!\\left(m_1(N),\\,v_1(N)\\right),\n\\] with posterior variance \\[\nv_1(N)\n=\n\\left[\n\\frac{1}{v_0(N)} + \\frac{n(N)}{\\sigma^2(N)}\n\\right]^{-1},\n\\] and posterior mean \\[\nm_1(N)\n=\nv_1(N)\\left[\n\\frac{m_0(N)}{v_0(N)} +\n\\frac{n(N)\\bar{Y}(N)}{\\sigma^2(N)}\n\\right].\n\\]\nThese expressions formalize the central mechanism of Bayesian updating: information from APSIM simulations is combined with field observations in proportion to their respective precisions. When \\(n(N)\\) is large, the OFPE mean has greater influence; when the prior variance \\(v_0(N)\\) is small, the posterior remains closer to the simulation-informed expectation. The posterior variance decreases as either the OFPE sample size grows or the prior becomes more informative.\nTo obtain a predictive distribution for yields, both uncertainty in the long-run mean and within-season stochastic variation must be incorporated. Conceptually, the posterior predictive density is \\[\nf_{\\text{post}}(y \\mid N)\n=\n\\int f(y \\mid \\mu_1(N))\\,\np(\\mu_1(N) \\mid \\text{data})\\,\nd\\mu_1(N),\n\\] a mixture reflecting uncertainty about the underlying mean combined with yield variability conditional on that mean Gelman et al. (2013). Because higher-order moments of the posterior cannot be inferred reliably from one or two OFPE years, the predictive density is represented via a maximum-entropy distribution matching the posterior mean, posterior variance, and prior-informed third moment Jaynes (1957a); Jaynes (1957b). This construction preserves essential moment information while remaining agnostic about unsupported distributional features.\nThe resulting predictive distribution enters the farmer’s economic decision problem: \\[\nN_{\\text{post}}^\\star\n=\n\\arg\\max_N\n\\Big\\{\np_y\\,\\mathbb{E}_{\\text{post}}[Y(N)] - p_n\\,N\n\\Big\\},\n\\] where \\(\\mathbb{E}_{\\text{post}}[Y(N)]\\) is evaluated under \\(f_{\\text{post}}(y \\mid N)\\) Antle (1983); Just and Pope (1990). The Bayesian method thus generates a nitrogen recommendation that reflects both agronomic knowledge encoded in APSIM and the local information obtained from OFPE experiments. As additional OFPE seasons accumulate, the posterior predictive distribution becomes increasingly shaped by field-level observations, and the decision rule progressively converges toward the field’s long-run optimum. In this way, the Bayesian method provides a coherent mechanism for integrating heterogeneous information sources into a unified and continuously improving decision-support system.\n\n\n\n\n\n\nAntle, John M. 1983. “Testing the Stochastic Structure of Production: A Flexible Moment-Based Approach.” American Journal of Agricultural Economics.\n\n\nBullock, David, Mikel Boerngen, et al. 2019. “The Data-Intensive Farm Management Project: Designing on-Farm Experiments.” Agricultural Systems.\n\n\nCasella, George, and Roger Berger. 2002. Statistical Inference. Duxbury Press.\n\n\nGelman, Andrew, John Carlin, Hal Stern, David Dunson, Aki Vehtari, and Donald Rubin. 2013. Bayesian Data Analysis. 3rd ed. CRC Press.\n\n\nHolzworth, Dean P, Neil I Huth, Peter G deVoil, Eric J Zurcher, Neville I Herrmann, Greg McLean, Karine Chenu, et al. 2014. “APSIM–Evolution Towards a New Generation of Agricultural Systems Simulation.” Environmental Modelling & Software 62: 327–50.\n\n\nJaynes, Edwin T. 1957a. “Information Theory and Statistical Mechanics.” Physical Review 106: 620–30.\n\n\n———. 1957b. “Information Theory and Statistical Mechanics II.” Physical Review 108: 171–90.\n\n\nJust, Richard E, and Rulon D Pope. 1990. “Studies in the Demand for Risky Inputs.” American Journal of Agricultural Economics.\n\n\nMieno, Taro et al. 2022. “Learning from on-Farm Precision Experiments: Estimating Field-Specific Nitrogen Response.” American Journal of Agricultural Economics.\n\n\nNaderi, Amir et al. 2020. “Long-Run Trends in County-Level Maize Yields.” Field Crops Research.",
    "crumbs": [
      "Bayesian-Hierarchical Analysis (2025)",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Bayesian Method</span>"
    ]
  },
  {
    "objectID": "08.Bayesian_Method.html#apsim-as-a-prior-moment-sequence",
    "href": "08.Bayesian_Method.html#apsim-as-a-prior-moment-sequence",
    "title": "8  Bayesian Method",
    "section": "8.1 2.1 APSIM as a prior moment sequence",
    "text": "8.1 2.1 APSIM as a prior moment sequence\nFor each APSIM cell and rate \\(N\\):\n\nmultiple weather-year simulations produce a distribution of yields\n\nwe compute:\n\n\\[\n\\mu_{1,0}(N),\\quad\n\\mu_{2,0}(N),\\quad\n\\mu_{3,0}(N)\n\\]\nThese represent the farmer’s prior belief about yield at rate \\(N\\):\na smooth, agronomically coherent curve shaped by water stress, mineralization, and APSIM physics.\nAPSIM provides:\n\nplausible curvature,\n\ndiminishing returns to nitrogen,\n\nrealistic year-to-year variance.\n\nBut it may misalign with a field’s yield level or responsiveness.",
    "crumbs": [
      "Bayesian-Hierarchical Analysis (2025)",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Bayesian Method</span>"
    ]
  },
  {
    "objectID": "08.Bayesian_Method.html#ofpe-as-noisy-sample-moments",
    "href": "08.Bayesian_Method.html#ofpe-as-noisy-sample-moments",
    "title": "8  Bayesian Method",
    "section": "8.2 2.2 OFPE as noisy sample moments",
    "text": "8.2 2.2 OFPE as noisy sample moments\nFor each field-year and OFPE cluster (strip) at nitrogen rate \\(N\\):\n\nthe raw OFPE observations yield:\n\n\\[\n\\bar{Y}(N),\\qquad s^2(N),\\qquad m_3(N),\n\\]\nwith \\(n(N)\\) observations in that cluster.\nThese moments reflect one realized season, containing:\n\nidiosyncratic weather shocks,\n\nfield-specific soil micro-variability,\n\nmeasurement noise.\n\nThus OFPE provides field-specific but imprecise evidence.",
    "crumbs": [
      "Bayesian-Hierarchical Analysis (2025)",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Bayesian Method</span>"
    ]
  },
  {
    "objectID": "08.Bayesian_Method.html#posterior-mean",
    "href": "08.Bayesian_Method.html#posterior-mean",
    "title": "8  Bayesian Method",
    "section": "8.3 3.1 Posterior mean",
    "text": "8.3 3.1 Posterior mean\nPosterior expected yield is a precision-weighted average:\n\\[\n\\mu_{1,\\text{post}}(N)\n=\n\\frac{\n  \\tau_0(N) \\mu_{1,0}(N)\n  +\n  \\tau_d(N)\\bar{Y}(N)\n}{\n  \\tau_0(N) + \\tau_d(N)\n}.\n\\]\nThis exhibits classical Bayesian shrinkage:\n\nWhen OFPE is noisy (\\(n\\) small, \\(s^2\\) large), the posterior relies more heavily on APSIM.\n\nWhen OFPE is dense and consistent, the posterior moves toward the sample mean.",
    "crumbs": [
      "Bayesian-Hierarchical Analysis (2025)",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Bayesian Method</span>"
    ]
  },
  {
    "objectID": "08.Bayesian_Method.html#posterior-variance",
    "href": "08.Bayesian_Method.html#posterior-variance",
    "title": "8  Bayesian Method",
    "section": "8.4 3.2 Posterior variance",
    "text": "8.4 3.2 Posterior variance\nPosterior precision is additive:\n\\[\n\\tau_{\\text{post}}(N) = \\tau_0(N) + \\tau_d(N),\n\\]\nwith variance:\n\\[\n\\mu_{2,\\text{post}}(N) = \\frac{1}{\\tau_{\\text{post}}(N)}.\n\\]\nPosterior uncertainty is always lower than either source alone,\nreflecting the information gain from combining two signals.",
    "crumbs": [
      "Bayesian-Hierarchical Analysis (2025)",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Bayesian Method</span>"
    ]
  },
  {
    "objectID": "08.Bayesian_Method.html#posterior-skewness-third-moment",
    "href": "08.Bayesian_Method.html#posterior-skewness-third-moment",
    "title": "8  Bayesian Method",
    "section": "8.5 3.3 Posterior skewness (third moment)",
    "text": "8.5 3.3 Posterior skewness (third moment)\nOFPE provides extremely noisy estimates of skewness.\nTherefore we adopt a prior-dominant update:\n\\[\n\\mu_{3,\\text{post}}(N) = \\mu_{3,0}(N),\n\\]\nretaining agronomic structure encoded in APSIM.",
    "crumbs": [
      "Bayesian-Hierarchical Analysis (2025)",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Bayesian Method</span>"
    ]
  },
  {
    "objectID": "09.Bayesian_Results.html",
    "href": "09.Bayesian_Results.html",
    "title": "9  Bayesian Results: Posterior Yield–N Curves and Economic Decisions",
    "section": "",
    "text": "1. Overview\nThis chapter presents the empirical results of the Bayesian moment–based updating framework developed in the previous sections. Using:\nwe quantify how trial data refine beliefs about field-specific nitrogen response and evaluate the implications for nitrogen recommendations and economic outcomes.\nThe results show:",
    "crumbs": [
      "Bayesian-Hierarchical Analysis (2025)",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Bayesian Results: Posterior Yield–N Curves and Economic Decisions</span>"
    ]
  },
  {
    "objectID": "09.Bayesian_Results.html#profit-results",
    "href": "09.Bayesian_Results.html#profit-results",
    "title": "9  Bayesian Results: Posterior Yield–N Curves and Economic Decisions",
    "section": "5.1 Profit results",
    "text": "5.1 Profit results\nAcross repeated fields:\n\nOFPE-only recommendations frequently underperform,\nsometimes generating losses due to overreaction to noisy data.\nAPSIM priors perform reasonably well,\nespecially in years where weather resembles long-run climate.\nPosterior decisions perform best overall,\nminimizing regret relative to the benchmark.\n\nThe posterior rarely performs worse than either source alone—\na direct consequence of Bayesian shrinkage.",
    "crumbs": [
      "Bayesian-Hierarchical Analysis (2025)",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Bayesian Results: Posterior Yield–N Curves and Economic Decisions</span>"
    ]
  },
  {
    "objectID": "09.Bayesian_Results.html#nitrogen-use-results",
    "href": "09.Bayesian_Results.html#nitrogen-use-results",
    "title": "9  Bayesian Results: Posterior Yield–N Curves and Economic Decisions",
    "section": "5.2 Nitrogen-use results",
    "text": "5.2 Nitrogen-use results\nData-only OFPE decisions:\n\noften over-apply N when yield bumps occur by chance,\n\nsometimes severely under-apply when local noise flattens the response.\n\nPosterior recommendations:\n\nmoderate these swings,\n\nmove N decisions toward more agronomically plausible rates,\n\nreduce variance in N-use across years.\n\nThis makes posterior-based decisions both economically efficient\nand operationally stable.",
    "crumbs": [
      "Bayesian-Hierarchical Analysis (2025)",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Bayesian Results: Posterior Yield–N Curves and Economic Decisions</span>"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Bayesian Yield–N Modeling",
    "section": "",
    "text": "Preface\nThis book documents the progress of a research project that began in 2022 with several hundred field-years of On-Farm Precision Experiment (OFPE) data. The initial objective was straightforward: use field-scale experimental data from multiple locations to predict yield–nitrogen response at a new, unseen field. To do this, we applied tree-based machine-learning models—primarily Random Forests and XGBoost—and evaluated their generalization using leave-one-location-out (LOLO) cross-validation. The results were clear: although these models captured within-field patterns, they provided almost no transferable information across space or years. In practice, data from one field-year offered little predictive value for another. The core reason is structural: the main covariates available in OFPE data-SSURGO1soil properties and DEM-derived2 topographic features—are static and cannot capture the dynamic interactions of soil nitrogen, soil moisture, weather, and crop physiology. This limitation motivated a fundamental shift in approach.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#transition-to-a-bayesian-framework",
    "href": "index.html#transition-to-a-bayesian-framework",
    "title": "Bayesian Yield–N Modeling",
    "section": "Transition to a Bayesian Framework",
    "text": "Transition to a Bayesian Framework\nBy 2025, the project evolved from a purely empirical ML framework into a Bayesian system that integrates mechanistic crop simulations with field observations. Rather than asking whether multi-field data alone can predict yield–N responses, the central question became: How can the APSIM3 generate scientifically grounded prior yield–N distributions for a region, and how can OFPE trials update these priors to produce field-specific posterior responses?",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#contents",
    "href": "index.html#contents",
    "title": "Bayesian Yield–N Modeling",
    "section": "Contents",
    "text": "Contents\nThis book reflects that progression.\nThe chapter Tree Ensemble Prediction (2022) revisits the original tree-model analysis and its limitations.\nThe chapter Bayesian–Hierarchical Analysis (2025) develops the Bayesian–APSIM framework, showing how mechanistic priors and OFPE field trials can be combined to produce uncertainty-aware and biologically interpretable yield–N distributions.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#footnotes",
    "href": "index.html#footnotes",
    "title": "Bayesian Yield–N Modeling",
    "section": "",
    "text": "Soil Survey Geographic Database (USDA NRCS)↩︎\nDigital Elevation Model using LiDAR↩︎\nAgricultural Production Systems sIMulator↩︎",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "09.Bayesian_Results(under revision).html",
    "href": "09.Bayesian_Results(under revision).html",
    "title": "9  Bayesian Results",
    "section": "",
    "text": "To be updated with",
    "crumbs": [
      "Bayesian-Hierarchical Analysis (2025)",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Bayesian Results</span>"
    ]
  },
  {
    "objectID": "09.Bayesian_Results(under revision).html#to-be-updated-with",
    "href": "09.Bayesian_Results(under revision).html#to-be-updated-with",
    "title": "9  Bayesian Results",
    "section": "",
    "text": "1. Visual diagram of producer(farmer)’s decision supporting system (with bayesian approach)\n\n\n2. Statitical Inference from the data anlaysis Results\n\n\n3. Dyanmic Optimizing behavior map of producer(farmer)",
    "crumbs": [
      "Bayesian-Hierarchical Analysis (2025)",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Bayesian Results</span>"
    ]
  }
]